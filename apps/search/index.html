<!doctype html>
<html lang="en" joblist-layout>
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>@joblist/components/search</title>
		<script type="module" src="../../src/index.js"></script>
		<script type="module">
			(({ query = "" }) => {
				const $search = document.createElement("joblist-search");
				const $results = document.createElement("joblist-results");
				$search.addEventListener("search", ({ detail }) => {
					console.log("ðŸŽ¯ Search event received:", detail);
					// Always set results, even if arrays are empty - let the component handle the display
					$results.setAttribute("results", JSON.stringify(detail));
				});
				if (query) {
					$search.setAttribute("query", query);
				}
				document
					.querySelector("joblist-page-main")
					.append($search, document.createElement("hr"), $results);
			})(Object.fromEntries(new URLSearchParams(window.location.search)));
		</script>
	</head>
	<body>
		<joblist-layout>
			<joblist-menu show-favicon="true" show-default="true"></joblist-menu>
			<joblist-page>
				<joblist-page-header>
					<header>
						<h1><a href="./"> Search </a></h1>
						<p>Explore companies and jobs indices.</p>
					</header>
				</joblist-page-header>
				<joblist-page-main> </joblist-page-main>
				<joblist-page-footer>
					<footer>
						<hr />
						<details>
							<summary>Info</summary>

							<p>
								Each column name of the database tables (companies, jobs) can be
								used to match rows for values, using the syntax
								<code>column_name:row_value</code> with the following examples.
							</p>

							<p>
								Search uses DuckDB's powerful text search capabilities across 
								multiple fields. Try partial matches and combine search terms.
								You can also explore the data using
								<a
									href="https://sqlime.org/#https://workers.joblist.today/joblist.db"
									>database explorer</a
								>.
							</p>

							<h2>Examples</h2>
							Search query syntax examples, as typed in the search input.
							<pre>
music
berlin software
remote developer
frontend
javascript react
london fintech</pre
							>

							<h3>Companies</h3>
							<dl>
								<dt>id:project_id</dt>
								<dd>
									The ID (unique identifier) of a company as referenced in
									joblist, for example <code>joblist.today/:company_id</code> or
									the name of the "data folder".
								</dd>
								<dt>tags:company_tag</dt>
								<dd>
									One or multiple "tags" used to describe a company, separated
									by "," (commas).
								</dd>
								<dt>city:world_city</dt>
								<dd>
									One or multiple "city" referenced in the company geographical
									"positions"
								</dd>
							</dl>

							<h3>Jobs</h3>
							<dl>
								<dt>id:job_id</dt>
								<dd>
									The ID (unique identifier) of a job as referenced in joblist
									(see the sqlite database explorer)
								</dd>
								<dt>location:location_string</dt>
								<dd>
									One or multiple locations, city names, country, as referenced
									by the job provider.
								</dd>
							</dl>
						</details>
					</footer>
				</joblist-page-footer>
			</joblist-page>
		</joblist-layout>
	</body>
</html>
